<!DOCTYPE html>
<html lang="en">
   <head>
      {% load static %}
      <meta charset="UTF-8">
      <meta name="viewport" content="width=device-width, initial-scale=1.0">
      <meta http-equiv="X-UA-Compatible" content="ie=edge">
      <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css">
      <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.8.2/css/all.css" integrity="sha384-oS3vJWv+0UjzBfQzYUhtDYW+Pj2yciDJxpsK1OYPAYjqT085Qq/1cq5FLXAZQ7Ay" crossorigin="anonymous">
      <link rel="shortcut icon" type="image/png" href="{% static 'vendor/assets/img/favicon.ico' %}" />
      <link href="https://fonts.googleapis.com/css?family=Roboto+Slab&display=swap" rel="stylesheet">
      <link rel="stylesheet" href="{% static 'vendor/assets/css/style.css' %}" />
      <link rel="stylesheet" href="{% static 'vendor/assets/css/style_loader.css' %}" />
      <title>Cashier Detailed Report(Oprtr)</title>
   </head>
   <body>
      <br>
      <div id="preloader">
         <img class="p" src="{% static 'vendor/assets/img/car2.gif' %}"></img>
      </div>
      <div class="container-fluid">
         <a href="#" id="test" onClick="javascript:fnExcelReport();" class="btn btn-success"><i
            class="far fa-file-excel"></i> Export To Excel</a>
         <table id="myTable" class="detail">
            {% for coms in com %}
            <tr>
               <td style="text-transform:uppercase">{{ coms.company }}</td>
            </tr>
            <tr>
               <td style="text-transform:uppercase">{{ coms.address }}</td>
            </tr>
            <tr>
               <td style="text-transform:uppercase">VAT REG TIN: {{coms.tin}}</td>
            </tr>
            {% endfor %}
         </table>
         <hr>
         <table id="myTable2">
            <tr>
               <td style="text-align:center; font-weight: bold; font-size: 18px;">CASHIERS DETAILED REPORT(BY OPERATOR)</td>
            </tr>
         </table>
         <table id="mytable3" class="detail">
            <tr>
            <tr>
               <td>Date From: {{ trans.timein|date:'M-d-Y H:i:s' }} </td>
            </tr>
            <tr>
               <td>Date To: {{ trans.timeout|date:'M-d-Y H:i:s' }}</td>
            </tr>
            <tr>
               <td>Generated by: {{user}}</td>
            </tr>
            <tr>
               <td>Operator: {{operator}}</td>
            </tr>
            <tr>
               <td>Total Transactions: {{ trans.txncount }}</td>
            </tr>
            <tr>
               <td>Gross Sales: {{trans.gross|floatformat:2}}</td>
            </tr>
            <tr>
               <td>VATABLE Sales: {{ trans.vatsales }}</td>
            </tr>
            <tr>
               <td>VAT Exempt Sales: {{ trans.vatexemptsales|floatformat:2  }}</td>
            </tr>
            <tr>
               <td>VAT Special Discount: {{ trans.vat_special|floatformat:2  }}</td>
            </tr>
            <tr>
               <td>SC/PWD Discount: {{trans.specialdiscount}}</td>
            </tr>
            <tr>
               <td>Other Discount: {{trans.discount}}</td>
            </tr>
            <tr>
               <td>VAT Payable {{ trans.vat_payable|floatformat:2  }}</td>
            </tr>
            <tr>
               <td>Net Sales: {{ trans.netsales|floatformat:2  }}</td>
            </tr>
         </table>
         <table id="mytable4" class="data table table-bordered table-hover">
            <thead class="thead-dark fixed">
               <th style="width: 100px;">ORNO</th>
               <th style="width: 70px;">POS</th>
               <th>DATE</th>
               <th>REFCODE</th>
               <th>VEHICLE</th>
               <th>PLATE #</th>
               <th>TIME-IN</th>
               <th>TIME-OUT</th>
               <th>DURATION</th>
               <th>GROSS SALES</th>
               <th>VATABLE SALES</th>
               <th>VAT EXEMPT SALES</th>
               <th>VAT SPECIAL DISCOUNT</th>
               <th>SC/PWD DISCOUNT</th>
               <th>OTHER DISCOUNT</th>
               <th>VAT PAYABLE</th>
               <th>NET SALES</th>
               <th>CASH AMOUNT</th>
               <th>VOUCHER AMOUNT</th>
               <th>CREDIT AMOUNT</th>
               <th>CREDIT TYPE</th>
            <tbody>
               {% for cas in cash %}
               <tr>
                  <td>{{ cas.or_number }}</td>
                  <td>{{ cas.pos_name }}</td>
                  <td>{{ cas.business_date|date:"m-d-Y"}}</td>
                  <td style="text-align:center">{{ cas.cardcode }}</td>
                  <td style="text-align:center">{{ cas.vehicle_type }}</td>
                  <td style="text-align:center">{{ cas.plate_num }}</td>
                  <td style="text-align:center">{{ cas.time_in|date:'m-d-Y H:i:s'  }}</td>
                  <td style="text-align:center">{{ cas.time_out|date:'m-d-Y H:i:s'  }}</td>
                  <td style="text-align:center">{{ cas.duration }}</td>
                  <td>{{ cas.gross_amount|floatformat:2 }}</td>
                  <td>{{ cas.vat_sales|floatformat:2 }}</td>
                  <td>{{ cas.vat_exempt_sales|floatformat:2 }}</td>
                  <td>{{ cas.vat_spcl_disc|floatformat:2 }}</td>
                  <td>{{ cas.discount_special|floatformat:2 }}</td>
                  <td>{{ cas.discount_regular|floatformat:2 }}</td>
                  <td>{{ cas.vat_payable|floatformat:2 }}</td>
                  <td>{{ cas.net_amount|floatformat:2 }}</td>
                  <td>{{ cas.cash|floatformat:2 }}</td>
                  <td>{{ cas.voucher|floatformat:2 }}</td>
                  <td>{{ cas.credit|floatformat:2 }}</td>
                  <td>-</td>
               </tr>
               {% endfor %}
               <tr>
                  <th colspan="9">TOTAL</th>
                  <th style="font-weight: bold">{{ trans.gross|floatformat:2 }}</th>
                  <th style="font-weight: bold">{{ trans.vatsales|floatformat:2 }}</th>
                  <th style="font-weight: bold">{{ trans.vatexemptsales|floatformat:2 }}</th>
                  <td style="font-weight: bold">{{ trans.vat_special|floatformat:2 }}</td>
                  <th style="font-weight: bold">{{ trans.specialdiscount|floatformat:2 }}</th>
                  <th style="font-weight: bold">{{ trans.discount|floatformat:2 }}</th>
                  <td style="font-weight: bold">{{ trans.vat_payable|floatformat:2 }}</td>
                  <th style="font-weight: bold">{{ trans.netsales|floatformat:2 }}</th>
                  <th style="font-weight: bold">{{ trans.cash|floatformat:2 }}</th>
                  <th style="font-weight: bold">{{ trans.voucher|floatformat:2 }}</th>
                  <th style="font-weight: bold">{{ trans.credit|floatformat:2 }}</th>
                  <th>-</th>
               </tr>
            </tbody>
         </table>
      </div>
      <script src="https://code.jquery.com/jquery-3.3.1.js"></script>
      <script src="https://cdn.jsdelivr.net/npm/jquery-bez@1.0.11/src/jquery.bez.js"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/2.1.2/TweenMax.min.js"></script>
      <script src="{% static 'vendor/assets/js/pace.js' %}"></script>
      <script>
         paceOptions = {
           ajax: true,
           document: true,
           eventLag: false
         };
         Pace.on('done', function () {
           $('.p').delay(500).animate({ top: '30%', opacity: '0' }, 3000, $.bez([0.19, 1, 0.22, 1]));
           $('#preloader').delay(1500).animate({ top: '-100%' }, 2000, $.bez([0.19, 1, 0.22, 1]));
           TweenMax.from(".title", 2, {
             delay: 1.8,
             y: 10,
             opacity: 0,
             ease: Expo.easeInOut
           })
         });
      </script>
      <script>
         function fnExcelReport() {
           var tab_text = '<html xmlns:x="urn:schemas-microsoft-com:office:excel">';
           tab_text = tab_text + '<head><xml><x:ExcelWorkbook><x:ExcelWorksheets><x:ExcelWorksheet>';

           tab_text = tab_text + '<x:Name>Cashier Detailed Report (OPERATOR)</x:Name>';

           tab_text = tab_text + '<x:WorksheetOptions><x:Panes></x:Panes></x:WorksheetOptions></x:ExcelWorksheet>';
           tab_text = tab_text + '</x:ExcelWorksheets></x:ExcelWorkbook></xml></head><body>';

           tab_text = tab_text + "<table border='0.5px'>";
           tab_text = tab_text + $('#myTable').html() + $('#myTable2').html() + $('#mytable3').html() + $('#mytable4').html();
           tab_text = tab_text + '</table></body></html>';

           var data_type = 'data:application/vnd.ms-excel';

           var ua = window.navigator.userAgent;
           var msie = ua.indexOf("MSIE ");

           var fileName = 'cashierdetailedoperator.xls';
           var blob = new Blob([tab_text], {
             type: "application/csv;charset=utf-8;"
           });

           if (window.navigator.msSaveBlob) {
             // FOR IE BROWSER
             navigator.msSaveBlob(blob, fileName);
           } else {
             // FOR OTHER BROWSERS
             var csvUrl = URL.createObjectURL(blob);
             $('#test').attr({
               'download': fileName,
               'href': csvUrl
             });
           }
         }

      </script>
   </body>
   <html>